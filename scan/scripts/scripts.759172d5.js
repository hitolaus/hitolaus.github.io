"use strict";angular.module("scanApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngFileUpload"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/ocr",{templateUrl:"views/ocr.html",controller:"OcrCtrl",controllerAs:"ocr"}).when("/card",{templateUrl:"views/card.html"}).when("/barcode",{templateUrl:"views/barcode.html",controller:"BarcodeCtrl",controllerAs:"barcode"}).otherwise({redirectTo:"/"})}]),angular.module("scanApp").controller("MainCtrl",["$scope","$location",function(a,b){a.insecure=0===b.absUrl().indexOf("http://")}]),angular.module("scanApp").controller("OcrCtrl",["$scope","Upload",function(a,b){function c(a,b){var c=document.getElementById("myCanvas"),d=c.getContext("2d"),e=new Image;e.onload=function(){d.drawImage(this,0,0),b()},e.src=a}a.upload=function(d){b.dataUrl(d).then(function(b){try{c(b,function(){var b=OCRAD(document.getElementById("myCanvas"));a.$apply(function(){a.data=b})})}catch(d){console.log(d)}})}}]),angular.module("scanApp").controller("BarcodeCtrl",["$scope","Upload",function(a,b){a.upload=function(a){b.dataUrl(a).then(function(a){var b={inputStream:{size:800},locator:{patchSize:"medium",halfSample:!1},numOfWorkers:1,decoder:{readers:[{format:"ean_reader",config:{}}]},locate:!0,src:a};Quagga.decodeSingle(b,function(){})})},Quagga.onDetected(function(b){a.$apply(function(){a.data=b.codeResult.code})}),Quagga.onProcessed(function(a){var b=Quagga.canvas.ctx.overlay,c=Quagga.canvas.dom.overlay;a&&(a.boxes&&(b.clearRect(0,0,parseInt(c.getAttribute("width")),parseInt(c.getAttribute("height"))),a.boxes.filter(function(b){return b!==a.box}).forEach(function(a){Quagga.ImageDebug.drawPath(a,{x:0,y:1},b,{color:"green",lineWidth:2})})),a.box&&Quagga.ImageDebug.drawPath(a.box,{x:0,y:1},b,{color:"#00F",lineWidth:2}),a.codeResult&&a.codeResult.code&&Quagga.ImageDebug.drawPath(a.line,{x:"x",y:"y"},b,{color:"red",lineWidth:3}))})}]),angular.module("scanApp").run(["$templateCache",function(a){a.put("views/barcode.html",'<p>Code: {{data}}</p> <div class="btn" ngf-select="upload($file)">SCAN</div> <div id="interactive" class="viewport"></div>'),a.put("views/card.html",'<p>This is the card view.</p> <input name="cardNumber" smopname="num" id="cardNumber-CC" class="cardNumber" type="text" value="************0891" pattern="[0-9]*">'),a.put("views/main.html",'<p> <a href="#/barcode" class="btn">BARCODE</a> <a href="#/ocr" class="btn">OCR</a> <a href="#/card" class="btn">CARD</a> </p> <p ng-if="insecure"> <a href="https://syscall.dk/scan"><i class="ion ion-locked"></i></a> </p>'),a.put("views/ocr.html",'<p>Code: {{data}}</p> <div class="btn" ngf-select="upload($file)">SCAN</div> <p> <canvas id="myCanvas"></canvas> </p>')}]);